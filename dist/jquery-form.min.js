function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,s,a,o,i=[],f=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);f=!0);}catch(e){l=!0,s=e}finally{try{if(!f&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw s}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}(N=>{N.fn.jqueryForm=function(e){var t=N.extend({beforeSend:null,onSuccess:null,onError:null,onComplete:null,validateBeforeSubmit:!0,method:null,action:null,extraData:{},resetOnSuccess:!1,processData:!1,contentType:!1},e);return this.each(function(){var H=N(this),J="";H.is("form")?(H.find(".jqf-response .alert").hide(),H.data("jqf-settings",t),H.off("submit.jqueryForm").on("submit.jqueryForm",function(e){e.preventDefault();var R=H.data("jqf-settings");if(!R.validateBeforeSubmit||(e=>{var t=!0;return t=e[0].checkValidity&&!e[0].checkValidity()?!1:t})(H)){if("function"==typeof R.beforeSend)if(!1===R.beforeSend.call(H,H))return!1;var t=new FormData(H[0]);if(R.extraData)for(var n in R.extraData)t.append(n,R.extraData[n]);e={url:R.action||H.attr("action"),method:R.method||H.attr("method")||"GET",data:t,processData:R.processData,contentType:R.contentType,beforeSend:function(){H.find(".jqf-response .alert-info").show("fast"),H.find(".jqf-response .alert button").show(),J=H.find("input, select, textarea").first().attr("name")},success:function(e,t,n){if(H.find(".jqf-response .alert").hide(),H.find(".jqf-response .jqf-response-html").empty(),H.find(".jqf-response .jqf-response-html").hide(),!1===n.getResponseHeader("Content-Type").includes("application/json"))H.find(".jqf-response .jqf-response-html").html(e),H.find(".jqf-response .jqf-response-html").show();else try{var r,s,a,o,i=n.status,f="",l="",c="",u=[];if(e.meta&&e.meta.response&&(f=null!=(r=e.meta.response.title)?r:"Success!",l=null!=(s=e.meta.response.message)?s:"Form submitted successfully",c=null!=(a=e.meta.response.redirect)?a:""),e.data&&e.data.attributes&&(u=null!=(o=e.data.attributes)?o:[]),H.find(".jqf-response .alert-success h4").text(f),H.find(".jqf-response .alert-success p").text(l),""===f&&""===l||H.find(".jqf-response .alert-success").show("fast"),200<=i&&i<300){R.resetOnSuccess&&H[0].reset(),"function"==typeof R.onSuccess&&R.onSuccess.call(H,e);for(var d=0,p=Object.entries(u);d<p.length;d++){var m=_slicedToArray(p[d],2),j=m[0],h=m[1],q=H.find('.jqf-container *[name="'+j+'"]');0<q.length&&q.val(h)}}else 300<=i&&i<400&&""!==c&&(H.find(".jqf-response .alert button").hide(),setTimeout(function(){window.location.href=c},1e3))}catch(e){H.find(".jqf-response .alert-danger h4").text("Error parsing JSON response"),H.find(".jqf-response .alert-danger p").text(e),H.find(".jqf-response .alert-danger").show("fast"),console.error(e)}},error:function(e,t,n){if(H.find(".jqf-response .alert").hide(),H.find(".jqf-response .jqf-response-html").empty(),H.find(".jqf-response .jqf-response-html").hide(),!1===e.getResponseHeader("Content-Type").includes("application/json"))H.find(".jqf-response .jqf-response-html").html(e.responseText);else try{var r,s,a,o,i,f,l,c,u=e.responseJSON,d=e.status,p=null!=(r=u.meta.response.title)?r:"Success!",m=null!=(s=u.meta.response.message)?s:"Form submitted successfully",j=null!=(a=u.meta.response.redirect)?a:"",h=null!=(o=u.meta.response.errors)?o:[],q=null!=(i=u.meta.response.type)?i:"",y=null!=(f=u.meta.response.file)?f:"",b=null!=(l=u.meta.response.line)?l:"",v=null!=(c=u.meta.response.stack_trace)?c:[],g=(""!==q&&""!==y&&""!==b&&(m=q+" in "+y+" at line "+b),".jqf-response .alert-warning");if(500<=d&&(g=".jqf-response .alert-danger"),H.find(g+" ul").empty(),H.find(g+" ul").hide(),H.find(g+" h4").text(p),H.find(g+" p").text(m),H.find(g).show("fast"),0<h.length||0<v.length){for(var x=0;x<h.length;x++){var S,T=h[x];""===J&&T.field&&(J=T.field),T.message&&((S=N("<li></li>")).text(T.message),H.find(g+" ul").append(S))}for(var w=H.find(g+" ul"),A=0;A<v.length;A++){for(var _=v[A],D=N("<li></li>"),F=N("<ul></ul>"),O=0,k=Object.entries(_);O<k.length;O++){var C=_slicedToArray(k[O],2),E=C[0],I=C[1],L=N("<li></li>");L.text(E+": "+I),F.append(L)}D.append("<p>Stack trace: "+A+"</p>"),D.append(F),w.append(D)}w.show()}400<=d&&d<600&&J&&(H.find('.jqf-container input[name="'+J+'"]').addClass("is-invalid"),H.find('.jqf-container textarea[name="'+J+'"]').addClass("is-invalid"),H.find('.jqf-container select[name="'+J+'"]').addClass("is-invalid")),"function"==typeof R.onError&&R.onError.call(H,e,t,n),300<=d&&d<400&&""!==j&&(H.find(".jqf-response .alert button").hide(),setTimeout(function(){window.location.href=j},1e3))}catch(e){H.find(".jqf-response jqf-response-html").text("Error parsing JSON response"),H.find(".jqf-response .alert-danger p").text(e),H.find(".jqf-response .alert-danger").show("fast"),console.error(e)}},complete:function(){"function"==typeof R.onComplete&&R.onComplete.call(H),N("html, body").animate({scrollTop:H.find(".jqf-response").offset().top-100},250)}};N.ajax(e)}return!1}),H.on("click",".jqf-action-retry",function(e){e.preventDefault(),H.find(".jqf-response .alert").hide("fast"),H.find(".jqf-response .jqf-response-html").empty(),""!==J&&(H.find('.jqf-container input[name="'+J+'"]').focus(),H.find('.jqf-container textarea[name="'+J+'"]').focus(),H.find('.jqf-container select[name="'+J+'"]').focus())}),H.on("click",".jqf-action-reset",function(e){e.preventDefault(),H[0].reset(),H.find(".jqf-response .alert").hide("fast"),H.find(".jqf-response .jqf-response-html").empty(),""!==J&&(H.find('.jqf-container input[name="'+J+'"]').focus(),H.find('.jqf-container textarea[name="'+J+'"]').focus(),H.find('.jqf-container select[name="'+J+'"]').focus())})):console.warn("jqueryForm: Element is not a form",H)})},N.fn.jqueryFormUpdate=function(n){return this.each(function(){var e=N(this),t=e.data("jqueryForm-settings")||{},t=N.extend({},t,n);e.data("jqf-settings",t)})},N.fn.jqueryFormReset=function(){return this.each(function(){var e=N(this);e[0].reset(),e.find("input, select, textarea").first().focus()})}})(jQuery);